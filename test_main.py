from unittest import TestCase

import main


class TestMain(TestCase):

    def test_main_decode_helmod(self):
        tst : str = """H4sIAAAAAAAA/81VTW+jMBD9KxVngyA0u11VHPcP9FpVyJhJYtVf8ke7UcV/3wEDYbNki3paLsE28+bNm+dJq++EZlTc1dUHb6tE6hZE/S0h+l2BrZITCK7NSTectaGFhDT4+aurPobfuohR4yIhikqoEhq8ltRzrVLHOCgGqaHs9TYo00H5qiBGv+N5sd/n+BCujhZajPeY7zlh2hiwqRHUQ/JSfcRcf+wSfza4xz3IC6jzeFTtOvKccIuUjkBt+n4CEBeU64N/AnXEWN0GFmndKnbGvqnG7RwF5rDAuAFM8TSK/IT6ctXCryr/TOeIHBEW6kbW+DkuDpR5bc8zSedANgIlTyVlJ64gLSccbAD35wnnngA28Xiuyofv2CfiDEBbFdluTwSX3CM7NFEQPfWOwOEAg1Dxs3wm8YaQuGRauSDNQAoPtRAhvneEUfOVsMUiy8urZ+Ree+2pmI02h4z7eVb8FciVCVh8RxqgmH3SLa7WeplPOt0/DEmYlo1G9dCt9SR+nu2X67ovy1MMLle1XHLHSj1HBsWXS0KPcfczcjxQ4WB2V1BohFfU3dsAV2Yak26RDDskaW+xJnDRorWw+lgph3h11kz3ssWSS6Hvu6kp/Vja2h0MukiLAOe5KUPRTos3HEVRl+m616MsGNB9Np2iljuycUrdmE4RpSTbp9QwOZwOlkXTjP3CYlx/J5I8+5GV+3GO1zhXduOk6d/LrZMt8iq2zaFrfrMv/k8zkIVdxyv8161avU/k2H9OsSSEoYwFGUS/mmu4bK1Sz3sToPGwv4aq5d/TcnMt8mGI9EBlCuqI4ixCl7vrgnWPFnyw6q5+BNX+BrftMJESCAAA"""
        expected_output = 'do local _={id="model_6",owner="heliophobicdude",blocks={block_1={id="block_1",name="automation-science-pack",owner="heliophobicdude",count=1,power=1550000,ingredients={["copper-plate"]={name="copper-plate",type="item",count=1,state=2},["iron-gear-wheel"]={name="iron-gear-wheel",type="item",count=1,state=2}},products={["automation-science-pack"]={name="automation-science-pack",type="item",count=1,state=1}},recipes={R1={id="R1",index=0,name="automation-science-pack",type="recipe",count=1,production=1,factory={name="assembling-machine-3",type="entity",count=4,energy=387500,speed=1.25,limit=0,modules={},effects={speed=0,productivity=0,consumption=0,pollution=0},cap={speed=0,productivity=0,consumption=0,pollution=0},pollution=0.03333333333333333,energy_total=1550000,pollution_total=0.13333333333333333,input=4},beacon={name="beacon",type="item",count=0,energy=480000,combo=4,per_factory=0.5,per_factory_constant=3,limit=0,modules={},energy_total=0},time=1,energy_total=1550000,pollution_total=0.13333333333333333}},isEnergy=false,index=0,unlinked=true,type="recipe",time=1,pollution_total=0.13333333333333333,summary={building=4,factories={["assembling-machine-3"]={name="assembling-machine-3",type="item",count=4}},beacons={beacon={name="beacon",type="item",count=0}},modules={}},by_factory=true,solver=false,products_linked={}}},ingredients={["copper-plate"]={index=2,name="copper-plate",type="item",count=1},["iron-gear-wheel"]={index=3,name="iron-gear-wheel",type="item",count=1}},resources={},time=1,version="0.9.35",block_id=2,recipe_id=3,products={["automation-science-pack"]={index=1,name="automation-science-pack",type="item",count=1}},summary={factories={["assembling-machine-3"]={name="assembling-machine-3",type="item",count=4}},beacons={beacon={name="beacon",type="item",count=0}},modules={},building=4,energy=1550000,pollution=0.13333333333333333},generators={accumulator={name="accumulator",type="item",count=40},["solar-panel"]={name="solar-panel",type="item",count=48},["steam-engine"]={name="steam-engine",type="item",count=4}}};return _;end'
        assert main.Main.decode(tst) == expected_output
